# 项目说明

## 项目概览
- 基于 `Vite` + `React 19` 的前端管理模板，结合 `Tailwind CSS v4`、`@tanstack/react-router` 文件路由、`@tanstack/react-query` 数据层、`zustand` 状态管理与 `shadcn/ui` 组件集。
- 入口在 `index.html` 与 `src/main.tsx`；路由树由插件自动生成在 `src/routeTree.gen.ts`。
- 提供认证布局、错误页、仪表盘、任务与用户列表等示例功能，支持主题与字体切换。

## 快速开始
- 开发：`npm run dev`
- 构建：`npm run build`
- 预览：`npm run preview`
- 代码检查：`npm run lint`
- 格式化：`npm run format` / `npm run format:check`

## 技术栈
- 框架与构建：`vite`、`@vitejs/plugin-react-swc`、`@tailwindcss/vite`、`@tanstack/router-plugin/vite`
- 路由与数据：`@tanstack/react-router`、`@tanstack/react-query`
- 状态与表单：`zustand`、`react-hook-form`、`zod`
- UI 与样式：`tailwindcss v4`、`shadcn/ui`、`radix-ui`、`lucide-react`、`@tabler/icons-react`
- 网络：`axios`
- 通知与图表：`sonner`、`recharts`

## 环境变量
- 在 `.env.development`、`.env.production`、`.env.staging` 中配置以 `VITE_` 为前缀的变量。
- 接口基础地址：`VITE_API_BASE_URL`，在 `src/utils/http.ts` 使用。

## 目录结构与文件说明

### 根目录
- `index.html`：应用根节点与字体/资源入口。
- `package.json`：依赖与脚本管理。
- `vite.config.ts`：Vite 配置与插件、路径别名。
- `tsconfig.json` / `tsconfig.app.json` / `tsconfig.node.json`：TypeScript 项目/应用/Node 配置。
- `eslint.config.js`：ESLint 规则，包含 React Hooks、Query 插件与禁止 `console` 等。（例如 `no-console`、严格未使用变量规则）
- `components.json`：`shadcn/ui` 配置与 Tailwind 集成，指定 `src/index.css`。
- `knip.config.ts`：Knip 未使用代码检测配置，忽略 `src/components/ui/**` 与 `src/routeTree.gen.ts`。
- `netlify.toml`：Netlify SPA 重写规则。
- `.github/`：Issue/PR 模板与 CI 工作流。
- `.env.*`：环境变量文件。
- `public/`：静态资源（favicon、logo 等）。

### src/
- `src/main.tsx`：应用入口与 Provider 注册。
  - 创建 `QueryClient`，配置重试策略、全局错误处理与 `QueryCache`（参考 `src/main.tsx:19-68`）。
  - 创建并挂载路由（`src/main.tsx:71-76`，`src/main.tsx:90-99`）。
  - 包装 `ThemeProvider`、`FontProvider`、`QueryClientProvider`。
- `src/index.css`：全局样式与主题变量、工具类与动画。
  - 引入 `tailwindcss` 与 `tw-animate-css`（`src/index.css:1-2`）。
  - `@theme inline` 定义 CSS 变量映射（`src/index.css:68-107`）。
- `src/routeTree.gen.ts`：由 TanStack Router 插件自动生成的路由树（勿手改）。

#### src/components/
- `layout/`：认证后整体布局与导航
  - `app-sidebar.tsx`：应用侧边栏容器。
  - `authenticated-layout.tsx`：认证布局，侧边栏 + 内容区（`src/components/layout/authenticated-layout.tsx:13-36`）。
  - `header.tsx`、`top-nav.tsx`：头部导航。
  - `nav-group.tsx`、`nav-user.tsx`、`team-switcher.tsx`：导航分组/用户菜单/团队切换。
  - `main.tsx`：主要内容容器。
  - `data/sidebar-data.ts`：侧边栏导航数据源。
  - `types.ts`：布局相关类型。
- `ui/`：通用 UI 组件（基于 `shadcn/ui` 与 `radix-ui`）
  - 反馈弹窗：`alert-dialog.tsx`、`dialog.tsx`
  - 警告与提示：`alert.tsx`、`tooltip.tsx`
  - 头像与徽章：`avatar.tsx`、`badge.tsx`
  - 按钮与开关：`button.tsx`、`switch.tsx`
  - 表单控件：`input.tsx`、`textarea.tsx`、`checkbox.tsx`、`radio-group.tsx`、`select.tsx`、`label.tsx`、`input-otp.tsx`
  - 布局与展示：`card.tsx`、`tabs.tsx`、`separator.tsx`、`scroll-area.tsx`、`skeleton.tsx`
  - 下拉与浮层：`dropdown-menu.tsx`、`popover.tsx`、`sheet.tsx`
  - 命令面板：`command.tsx`
  - 侧边栏系统：`sidebar.tsx`（含 `SidebarProvider`）
  - 通知：`sonner.tsx`（`Toaster` 在根路由使用）
- 通用业务组件：
  - `command-menu.tsx`、`confirm-dialog.tsx`、`navigation-progress.tsx`、`password-input.tsx`、`profile-dropdown.tsx`、`search.tsx`、`select-dropdown.tsx`、`theme-switch.tsx`、`coming-soon.tsx`、`long-text.tsx`、`skip-to-main.tsx`
- `assets/`：静态 TSX 资源，如 `clerk-logo.tsx`、`vite.svg`。

#### src/context/
- `theme-context.tsx`：主题上下文，管理 `dark/light/system` 与 `documentElement` 类（`src/context/theme-context.tsx:33-55`），`useTheme` 钩子（`src/context/theme-context.tsx:75-81`）。
- `font-context.tsx`：字体上下文，从 `src/config/fonts.ts` 读取允许字体并应用 `font-*` 类。
- `search-context.tsx`：页面内搜索上下文。

#### src/config/
- `fonts.ts`：可选字体列表与添加新字体的说明。

#### src/lib/
- `utils.ts`：工具函数，如 `cn` 用于合并类名。

#### src/hooks/
- `use-dialog-state.tsx`：对话框状态管理 Hook。
- `use-mobile.tsx`：移动端适配相关 Hook。

#### src/features/
- `auth/`：认证模块
  - `auth-layout.tsx`：认证页面的布局容器。
  - `sign-in/`、`sign-up/`、`forgot-password/`、`otp/`：对应页面与表单组件（如 `user-auth-form.tsx`、`sign-up-form.tsx`、`forgot-password-form.tsx`、`otp-form.tsx`）。
  - 示例：`sign-in/index.tsx` 登录页（`src/features/auth/sign-in/index.tsx:12-47`）。
- `dashboard/`：仪表盘
  - 组件：`components/overview.tsx`、`recent-sales.tsx`。
- `apps/`：示例应用列表
  - 数据：`data/apps.tsx`；入口 `index.tsx`。
- `chats/`：聊天示例
  - 组件：`components/new-chat.tsx`；数据：`data/convo.json`、类型 `data/chat-types.ts`。
- `tasks/`：任务列表模块（基于 TanStack Table）
  - 表格与交互：`components/data-table.tsx`、`columns.tsx`、`data-table-*`、`tasks-dialogs.tsx`、`tasks-mutate-drawer.tsx`、`tasks-primary-buttons.tsx` 等。
  - 上下文：`context/tasks-context.tsx`；数据与 schema：`data/data.tsx`、`data/tasks.ts`、`data/schema.ts`。
- `users/`：用户列表模块
  - 表格与交互：`components/users-table.tsx`、`users-columns.tsx`、`users-dialogs.tsx`、`users-primary-buttons.tsx`、`users-delete-dialog.tsx`、`users-invite-dialog.tsx` 等。
  - 上下文：`context/users-context.tsx`；数据与 schema：`data/data.ts`、`data/users.ts`、`data/schema.ts`。
- `errors/`：错误页面组件（`unauthorized-error.tsx`、`forbidden.tsx`、`not-found-error.tsx`、`general-error.tsx`、`maintenance-error.tsx`）。

#### src/routes/
- 根路由：`__root.tsx`，使用 `NavigationProgress`、`Toaster`、开发环境下 DevTools（`src/routes/__root.tsx:16-24`）。
- 认证区：`_authenticated/route.tsx` 指向 `AuthenticatedLayout`（`src/routes/_authenticated/route.tsx:4-5`）。
- 业务入口：
  - `/_authenticated/index.tsx`：认证后首页容器。
  - `/_authenticated/apps/index.tsx`、`/chats/index.tsx`、`/tasks/index.tsx`、`/users/index.tsx` 等。
  - 设置页：`/_authenticated/settings/route.tsx`、子路由 `appearance.tsx`、`account.tsx`、`display.tsx`、`notifications.tsx`、`index.tsx`。
- 分组路由：
  - `(auth)/`：`sign-in.tsx`、`sign-in-2.tsx`、`sign-up.tsx`、`forgot-password.tsx`、`otp.tsx`。
  - `(errors)/`：`401.tsx`、`403.tsx`、`404.tsx`、`500.tsx`、`503.tsx`。

#### src/stores/
- `authStore.ts`：全局认证状态（`user`、`accessToken`）与 Cookies 持久化，提供重置动作（`src/stores/authStore.ts:29-58`）。

#### src/utils/
- `http.ts`：Axios 实例，注入 `Authorization`，统一响应错误处理（`src/utils/http.ts:11-40`）。
- `handle-server-error.ts`：将错误转为用户可读的消息并 toast（`src/utils/handle-server-error.ts:19-23`）。
- `show-submitted-data.tsx`：通用提交结果显示工具。

### 其它文件
- `src/assets/`：图标与徽标 TSX 文件（如 `clerk-logo.tsx`）。
- `public/images/`：favicon 与项目图片资源。

## 路由与数据流
- 路由：由文件系统路由生成，插件写入 `src/routeTree.gen.ts` 并在 `src/main.tsx` 引用（`src/main.tsx:17`）。
- 数据层：`QueryClient` 配置重试与错误处理（`src/main.tsx:19-48`），`QueryCache.onError` 进行会话过期、服务器错误跳转与通知（`src/main.tsx:50-66`）。

## 主题与样式
- 主题上下文：`ThemeProvider` 管理 `dark/light/system` 并动态切换根元素类（`src/context/theme-context.tsx:33-55`）。
- 字体上下文：`FontProvider` 应用 `font-*` 类；字体列表在 `src/config/fonts.ts`。
- Tailwind v4：通过 `src/index.css` 的 `@theme inline` 与 CSS 变量实现主题与设计令牌，提供 `container`、`no-scrollbar` 等工具类。

## 网络与错误处理
- Axios 拦截器自动注入 `Authorization` 并统一错误处理；错误文案通过 `sonner` 弹出。
- 遇到 401 时重置认证并跳转登录；500 跳转错误页；304 显示未修改提示（参考 `src/main.tsx:38-46`、`src/main.tsx:50-66`）。

## 代码约定
- 严格 TypeScript 配置与路径别名 `@/*`。
- ESLint 禁用 `console`；使用 `react-refresh/only-export-components`；规范未使用变量（`eslint.config.js:25-45`）。
- `components/ui` 目录被 ESLint/Knip 忽略以减少噪音（生成或第三方风格组件）。

## 开发建议
- 从 `src/main.tsx` 与 `src/routes/__root.tsx` 理解应用装配。
- 路由到页面：在 `src/routes/**` 找入口，再定位 `src/features/**` 页面与其组件。
- 统一异步错误：封装在 `src/utils/http.ts` 与 `src/utils/handle-server-error.ts`。
- 复用 UI：优先使用 `src/components/ui` 与已有通用组件。
